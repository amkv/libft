везде должны быть unsigned char
там где это возможно использовать свои собственные функции
дописать еще +4 собственные функции